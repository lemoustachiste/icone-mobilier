"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = ensureIssuerSignature;

var _constants = require("../constants");

var _bitcoinjsLib = _interopRequireDefault(require("bitcoinjs-lib"));

var _verifierError = _interopRequireDefault(require("../models/verifierError"));

var _useCases = require("../domain/i18n/useCases");

function ensureIssuerSignature(issuerKey, certificateUid, certificateSignature, chain) {
  const bitcoinChain = chain === _constants.BLOCKCHAINS.bitcoin.code ? _bitcoinjsLib.default.networks.bitcoin : _bitcoinjsLib.default.networks.testnet;

  if (!_bitcoinjsLib.default.message.verify(issuerKey, certificateSignature, certificateUid, bitcoinChain)) {
    throw new _verifierError.default((0, _useCases.getText)('errors', 'ensureIssuerSignature'));
  }
}