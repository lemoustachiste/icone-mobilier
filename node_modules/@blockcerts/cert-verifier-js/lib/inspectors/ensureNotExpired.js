"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = ensureNotExpired;

var _date = require("../helpers/date");

var _verifierError = _interopRequireDefault(require("../models/verifierError"));

var _verificationSubSteps = require("../constants/verificationSubSteps");

var _useCases = require("../domain/i18n/useCases");

function ensureNotExpired(expires = null) {
  if (!expires) {
    return;
  }

  const expiryDate = (0, _date.dateToUnixTimestamp)(expires);
  const today = new Date();

  if (today.getTime() >= expiryDate) {
    throw new _verifierError.default(_verificationSubSteps.SUB_STEPS.checkExpiresDate, (0, _useCases.getText)('errors', 'ensureNotExpired'));
  }
}